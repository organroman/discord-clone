{"version":3,"sources":["../src/internal/s3-error-parser.ts"],"sourcesContent":["import type { UploadThingError } from \"@uploadthing/shared\";\n\nexport const maybeParseResponseXML = (maybeXml: string) => {\n  const codeMatch = maybeXml.match(/<Code>(.*?)<\\/Code>/s);\n  const messageMatch = maybeXml.match(/<Message>(.*?)<\\/Message>/s);\n\n  const code = codeMatch?.[1];\n  const message = messageMatch?.[1];\n\n  if (!code || !message) return null;\n\n  return { code: s3CodeToUploadThingCode[code] ?? DEFAULT_ERROR_CODE, message };\n};\n\n/**\n * Map S3 error codes to UploadThing error codes\n *\n * This is a subset of the S3 error codes, based on what seemed most likely to\n * occur in uploadthing. For a full list of S3 error codes, see:\n * https://docs.aws.amazon.com/AmazonS3/latest/API/ErrorResponses.html\n */\nconst DEFAULT_ERROR_CODE = \"UPLOAD_FAILED\";\nconst s3CodeToUploadThingCode: Record<string, UploadThingError[\"code\"]> = {\n  AccessDenied: \"FORBIDDEN\", // 403 Forbidden\n  EntityTooSmall: \"TOO_SMALL\", // 400 Bad Request\n  EntityTooLarge: \"TOO_LARGE\", // 400 Bad Request\n  ExpiredToken: \"FORBIDDEN\", // 400 Bad Request\n  IncorrectNumberOfFilesInPostRequest: \"TOO_MANY_FILES\", // 400 Bad Request\n  InternalError: \"INTERNAL_SERVER_ERROR\", // 500 Internal Server Error\n  KeyTooLongError: \"KEY_TOO_LONG\", // 400 Bad Request\n  MaxMessageLengthExceeded: \"TOO_LARGE\", // 400 Bad Request\n};\n"],"mappings":";AAEO,IAAM,wBAAwB,CAAC,aAAqB;AACzD,QAAM,YAAY,SAAS,MAAM,sBAAsB;AACvD,QAAM,eAAe,SAAS,MAAM,4BAA4B;AAEhE,QAAM,OAAO,uCAAY;AACzB,QAAM,UAAU,6CAAe;AAE/B,MAAI,CAAC,QAAQ,CAAC;AAAS,WAAO;AAE9B,SAAO,EAAE,MAAM,wBAAwB,IAAI,KAAK,oBAAoB,QAAQ;AAC9E;AASA,IAAM,qBAAqB;AAC3B,IAAM,0BAAoE;AAAA,EACxE,cAAc;AAAA;AAAA,EACd,gBAAgB;AAAA;AAAA,EAChB,gBAAgB;AAAA;AAAA,EAChB,cAAc;AAAA;AAAA,EACd,qCAAqC;AAAA;AAAA,EACrC,eAAe;AAAA;AAAA,EACf,iBAAiB;AAAA;AAAA,EACjB,0BAA0B;AAAA;AAC5B;","names":[]}